name: OS Compatibility Tests

on: [push, pull_request]

jobs:
  xenial:
    name: Ubuntu 16.04 (xenial)
    runs-on: ubuntu-16.04
    steps:
    - uses: actions/checkout@v1
    - name: Install Dependencies
      run: |
        sudo apt update -yq
        sudo apt install -yq --no-install-recommends python3-setuptools python3-pip g++ gfortran gobjc gobjc++ zlib1g-dev
        sudo python3 -m pip install pytest-xdist pytest-forked pytest
    - name: Install ninja-build tool
      uses: seanmiddleditch/gha-setup-ninja@v1
    - name: Python version
      run: python3 --version
    - name: Ninja version
      run: ninja --version
    - name: Run tests
      run: python3 run_tests.py
      env:
        CI: '1'
        XENIAL: '1'
