name: Panorama_Gem CI

on: [push]

jobs:
  test:

    runs-on: ubuntu-latest

    env:
      JRUBY_VERSION: jruby-9.2.6.0
      # Panorama dir after git clone
      PANORAMA_DIR: /home/runner/work/Panorama_Gem/Panorama_Gem

    steps:
    - uses: actions/checkout@v1
    - name: Check OS prerequisites
      run: |
        docker ps -a
        docker images
        java -version

    - name: Set up RVM
      run: |
        curl -sSL https://get.rvm.io | bash

    - name: Install JRuby
      run: |
        source $HOME/.rvm/scripts/rvm
        rvm install ${JRUBY_VERSION}
        rvm --default use ${JRUBY_VERSION}

    - name: Install Chrome
      run: |
        wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
        sudo dpkg -i google-chrome-stable_current_amd64.deb || apt-get -y -f install

    - name: bundle install
      run: |
        cd ${PANORAMA_DIR} && bundle install

