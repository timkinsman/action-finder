name: build_and_test

on: [push, pull_request]

jobs:
    linux:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v1
        - name: prepare
          run: |
            sudo apt-get update
            sudo apt-get install mesa-common-dev libgl1-mesa-dev libpulse-dev libxrandr-dev
            sudo apt-get install libgtk-3-dev
        - name: linux-make-debug64
          run: |
            make linux-debug64 MAKE_JOBS=2
        - name: linux-test-debug64
          run: |
            ./build/linux64/bin/crown-debug --run-unit-tests
        - name: linux-make-development64
          run: |
            make linux-development64 MAKE_JOBS=2
        - name: linux-test-development64
          run: |
            ./build/linux64/bin/crown-development --run-unit-tests
        - name: linux-make-release64
          run: |
            make linux-release64 MAKE_JOBS=2
        - name: linux-test-release64
          run: |
            ./build/linux64/bin/crown-release --run-unit-tests
